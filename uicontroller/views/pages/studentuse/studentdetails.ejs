<%- include('../../partials/studentuse/header.ejs', { studentAppURL: studentAppURL, title: 'Student Details' }) %>
<%- include('../../partials/studentuse/nonloginlayout.ejs', { subTitle: 'Student' }) %>
<%- include('../../partials/breadcrumb.ejs', { breadCrumbs: breadCrumbs }) %>
<%- include('../../partials/studentuse/aside.ejs', { activeMenu: 'student' }) %>
<section class="section profile">
    <div class="row">
        <div class="col-xl-4">
            <div class="card">
                <div class="card-body profile-card pt-4 d-flex flex-column align-items-center">
                  <img src="" alt="Profile" class="rounded-circle" id="image" name="image">
                  <h2 id="userName"></h2>
                  <h3>Student</h3>
                  <div class="social-links mt-2">
                    <a href="#" class="twitter"><i class="bi bi-twitter"></i></a>
                    <a href="#" class="facebook"><i class="bi bi-facebook"></i></a>
                    <a href="#" class="instagram"><i class="bi bi-instagram"></i></a>
                    <a href="#" class="linkedin"><i class="bi bi-linkedin"></i></a>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-xl-8">
              <div class="card">
                <div class="card-body pt-3">
                  <!-- Bordered Tabs -->
                  <ul class="nav nav-tabs nav-tabs-bordered">

                    <li class="nav-item">
                      <button class="nav-link active" data-bs-toggle="tab"
                        data-bs-target="#profile-overview">Overview</button>
                    </li>

                    <li class="nav-item">
                      <button class="nav-link" data-bs-toggle="tab" data-bs-target="#profile-edit">Edit Image</button>
                    </li>

                  </ul>
                  <div class="tab-content pt-2">
                    <div class="tab-pane fade show active profile-overview" id="profile-overview">
                      <h5 class="card-title">Student Details</h5>
                      <div class="row">
                        <div class="col-lg-3 col-md-4 label">Name</div>
                        <div class="col-lg-9 col-md-8" id="name"></div>
                      </div>

                      <div class="row">
                        <div class="col-lg-3 col-md-4 label">Register Number</div>
                        <div class="col-lg-9 col-md-8" id="registerNum"></div>
                      </div>

                      <div class="row">
                        <div class="col-lg-3 col-md-4 label">DOB</div>
                        <div class="col-lg-9 col-md-8" id="dob"></div>
                      </div>

                      <div class="row">
                        <div class="col-lg-3 col-md-4 label">Course</div>
                        <div class="col-lg-9 col-md-8" id="course"></div>
                      </div>

                      <div class="row">
                        <div class="col-lg-3 col-md-4 label">Email Id</div>
                        <div class="col-lg-9 col-md-8" id="email"></div>
                      </div>

                      <div class="row">
                        <div class="col-lg-3 col-md-4 label">Phone Number</div>
                        <div class="col-lg-9 col-md-8" id="studNum"></div>
                      </div>

                      <div class="row">
                        <div class="col-lg-3 col-md-4 label">Father Name</div>
                        <div class="col-lg-9 col-md-8" id="fatherName"></div>
                      </div>

                      <div class="row">
                        <div class="col-lg-3 col-md-4 label">Father Number</div>
                        <div class="col-lg-9 col-md-8" id="fatherNum"></div>
                      </div>

                      <div class="row">
                        <div class="col-lg-3 col-md-4 label">Address</div>
                        <div class="col-lg-9 col-md-8" id="address"></div>
                      </div>

                      <div class="row">
                        <div class="col-lg-3 col-md-4 label">Block Code</div>
                        <div class="col-lg-9 col-md-8" id="blockCode"></div>
                      </div>

                      <div class="row">
                        <div class="col-lg-3 col-md-4 label">Floor Number</div>
                        <div class="col-lg-9 col-md-8" id="floorNumber"></div>
                      </div>

                      <div class="row">
                        <div class="col-lg-3 col-md-4 label">Room Number</div>
                        <div class="col-lg-9 col-md-8" id="roomNumber"></div>
                      </div>

                      <div class="row">
                        <div class="col-lg-3 col-md-4 label">Joined Date</div>
                        <div class="col-lg-9 col-md-8" id="joinedDate"></div>
                      </div>
                    </div>
                    <div class="tab-pane fade profile-edit pt-3" id="profile-edit">

                      <!-- Profile Edit Form -->
                      <div>
                        <div class="row mb-3">
                          <label for="profileImage" class="col-md-4 col-lg-3 col-form-label">Student Image</label>
                          <div class="col-md-8 col-lg-9">
                            <div style="position: relative; display: inline-block;">
                              <!-- Spinner -->
                              <span class="spinner-border text-secondary spinner2" id="spinner"></span>
                              <!-- Profile Image -->
                              <img src="" alt="Profile" id="editProfile" >
                            </div>                            
                            <div class="pt-2">
                              <a class="btn btn-primary btn-sm" title="Upload new profile image"
                                onclick="changeImageDom.click()">
                                <input class="form-control" type="file" id="changeImage" 
                                name="image" onchange="updateAvatar()" style="display: none;">
                                <i class="bi bi-upload"></i></a>
                              <a href="javascript:void(0);" class="btn btn-danger btn-sm" title="Remove my profile image"
                                onclick="deleteAvatar()"><i class="bi bi-trash"></i></a>
                            </div>
                          </div>
                        </div>
                    
                      </div>                        
                    </div>

                  </div><!-- End Bordered Tabs -->
                </div>
              </div>
            </div>
        </div>
  </section>
</main>
<%- include('../../partials/studentuse/footer.ejs') %>
<script>
    const nameDom = document.getElementById('name');
    const registerNumDom = document.getElementById('registerNum');
    const dobDom = document.getElementById('dob');
    const courseDom = document.getElementById('course');
    const emailIdDom = document.getElementById('email');
    const studNumDom = document.getElementById('studNum');
    const fatherNameDom = document.getElementById('fatherName');
    const fatherNumDom = document.getElementById('fatherNum');
    const addressDom = document.getElementById('address');
    const blockCodeDom = document.getElementById('blockCode');
    const floorNumberDom = document.getElementById('floorNumber');
    const roomNumberDom = document.getElementById('roomNumber');
    const joinedDateDom = document.getElementById('joinedDate');
    
    async function studentDetails() {
      try {
        const response = await fetch(getStudentAppUrl('api/student/details'));
        const student = await response.json();
        nameDom.innerText = student.name;
        registerNumDom.innerText = student.registerNumber;
        dobDom.innerText = student.birth
        courseDom.innerText = student.courseName;
        emailIdDom.innerText = student.emailId;
        studNumDom.innerText = student.phoneNumber;
        fatherNameDom.innerText = student.fatherName;
        fatherNumDom.innerText = student.fatherNumber;
        addressDom.innerText = student.address;
        blockCodeDom.innerText = student.blockCode;
        floorNumberDom.innerText = student.floorNumber;
        roomNumberDom.innerText = student.roomNumber;
        joinedDateDom.innerText = student.joinDate;
      } catch (error) {
          alert('Something went wrong.Please try later.')
      }
    }

    window.addEventListener('load',()=> {
        studentDetails()
    })
</script>
