<%- include('../partials/header.ejs', { isMenuVisible: false, title: 'login' }) %>
    <form class="container my-5" style="width: 400px;">
      <h2 class="topLabel text-primary mx-5">Hostel-Attendance</h2>
      <p class="font-weight-bold">Login</p>
      <div class="form-group mx-auto">
        <label for="exampleInputEmail1">Email</label>
        <input type="email" class="form-control" id="emailId" aria-describedby="emailHelp" placeholder="Enter email"
          onkeyup="toggleLoginButton()">
      </div>
      <div class="form-group">
        <label for="exampleInputPassword1">Password</label>
        <input type="password" class="form-control" id="password" placeholder="Password" onkeyup="toggleLoginButton()">
      </div>
      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="exampleCheck1" onclick="secure()">
        <label class="form-check-label" for="exampleCheck1">Show Password</label>
        <a href="#" class="link-primary mx-4">forgotten password?</a>
      </div>
     
      <button type="submit" class="btn btn-primary my-3" onclick="loginUser()" id="loginButton" disabled>Login</button>
    </form>
  <script>
    const loginButton = document.getElementById('loginButton')
    const emailId = document.getElementById('emailId')
    const password = document.getElementById('password')

    function loginUser() {
      const myHeaders = new Headers();
      myHeaders.append("Content-Type", "application/json");

      const raw = JSON.stringify({
        "emailId": emailId.value,
        "password": password.value
      });

      const requestOptions = {
        method: "POST",
        headers: myHeaders,
        body: raw,
        redirect: "follow"
      };

      const request = fetch("http://localhost:1000/api/login", requestOptions)
      request.then(async (response) => {
        if (response.status === 200) {
          window.location.replace("http://localhost:1000/home")
        } else {
          alert(await response.text())
        }
      })
    }

    function secure() {
      var password = document.getElementById("password");
      if (password.type === "password") {
        password.type = "text"
      } else {
        password.type = "password"
      }
    }

    function toggleLoginButton() {
      loginButton.disabled = !(emailId.value.length > 0 && password.value.length > 0)
    }

  </script>

  <%- include('../partials/footer.ejs') %>